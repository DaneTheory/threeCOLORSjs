<!DOCTYPE html>
<html>
<head>
<title>Repo Browser - refresh to see file list again</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script src="https://raw.github.com/tkyk/jquery-history-plugin/master/jquery.history.js"></script>
<style>
html, body, iframe { width: 100%; height: 100%; margin: 0; padding: 0; border: 0; }
iframe { height: 99%; }
#container { width: 400px; margin: 50px auto; background: #eee; border: 1px solid #ccc; padding: 30px; }
#container a {display: block; margin: 5px; color: #333; }
</style>
</head>
<body>
<div id="container"></div>
<script>
  var container = $('#container');
  var treeUrl = 'https://api.github.com/repos/vincentwoo/threeCOLORSjs/git/trees/master?callback=?';
  function init() {
    $('iframe').remove();
    container.show();
    if (container.html()) return;
    $.getJSON(treeUrl, function(response) {
      $.each(response.data.tree, function(idx, blob) {
        container.append($('<a/>', {
          text: blob.path,
          href: "#",
          click: function() {
            $.history.load(blob.url);
            return false;
          }
        }));
      });
    });
  }
  function loadFile(blobUrl) {
    $.getJSON(blobUrl + "?callback=?", function(response) {
      var content = atob(response.data.content.replace(/\n/g, ""));
      container.hide();
      var iframe = document.createElement("iframe");
      $('body').append(iframe);
      var doc = iframe.document;
      if (iframe.contentDocument)
        doc = iframe.contentDocument; // For NS6
      else if (iframe.contentWindow)
        doc = iframe.contentWindow.document; // For IE5.5 and IE6
      // Put the content in the iframe
      doc.open();
      doc.writeln(content);
      doc.close();
    });
  }
   $.history.init(function(hash) {
      if(!hash) {
        init();
      } else {
        loadFile(hash);
      }
    },
    { unescape: ":,/" });
</script>
</body>
</html>