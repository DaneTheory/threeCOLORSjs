<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script src="https://raw.github.com/mrdoob/three.js/master/build/Three.js"></script>
<script src="https://raw.github.com/mrdoob/three.js/master/examples/js/RequestAnimationFrame.js"></script>
<style>
  * {margin: 0; padding: 0;}
  #canvas {
    width: 1280px;
    height: 720px;
    margin: 0 auto;
    border: 1px solid #eee;
  }
</style>
</head>

<body>
  <div id="canvas"></div>

  <script type="text/javascript">
    var camera, scene, renderer, geometry, material, mesh, container, pointLight, cubes;
    var lastTime = Date.now();

    init();
    animate(Date.now());

    function init() {
      container = $('#canvas');
      
      camera = new THREE.PerspectiveCamera( 50, container.innerWidth() / container.innerHeight(), 1, 10000 );
      camera.position.set(60, 60, 60);
      camera.lookAt(new THREE.Vector3(10, 0, 10));
      camera.up.set(0, 0, 1);
      
      scene = new THREE.Scene();
      
      cubes = [];
      for (var i = -50; i < 50; i += 10) {
        var arr = [];
        for (var j = -50; j < 50; j += 10) {
          geometry = new THREE.CubeGeometry(8, 8, 8);
          material = new THREE.MeshPhongMaterial({ color: 0xffffff, shading: THREE.SmoothShading });
          mesh = new THREE.Mesh(geometry, material);
          mesh.position.set(i, 4, j);
          mesh.castShadow = true;
          scene.add(mesh);
          arr.push(mesh);
        }
        cubes.push(arr);
      } 
      
      var plane = new THREE.PlaneGeometry(8, 8, 8, 8);
      var meshCanvas = new THREE.Mesh(plane, new THREE.MeshLambertMaterial({ color: 0xAAAAAA, shading: THREE.SmoothShading }));
      meshCanvas.rotation.x = -90 * Math.PI / 180;
      meshCanvas.scale.x = meshCanvas.scale.y = meshCanvas.scale.z = 200;
      meshCanvas.receiveShadow = true;
      scene.add(meshCanvas);
      
      pointLight = new THREE.SpotLight( 0xFFFFFF );
      pointLight.position.set(0, 500, 300);
      pointLight.castShadow = true;
      scene.add(pointLight);
      
      var ambientLight = new THREE.AmbientLight( 0x222222 );
      scene.add(ambientLight);

      renderer = new THREE.WebGLRenderer({antialias: true});
      renderer.setSize( container.innerWidth(), container.innerHeight() );
      renderer.clear();
      renderer.shadowMapEnabled = true;
      renderer.shadowMapWidth = 2000;
      renderer.shadowMapHeight = 2000;

      container.append( renderer.domElement );
    }

    function animate(time) {
      var delta = (time - lastTime) / 1000.0;
      for (var i = 0; i < cubes.length; i++) {
        for (var j = 0; j < cubes.length; j++) {
          var factor = (Math.sin(i + time / 1000.0) + Math.sin(j + time / 1000.0)) / 4 + 0.5;
          cubes[i][j].position.y = 4 + 15 * factor;
          cubes[i][j].materials[0].color.setRGB( 1 , 1-factor , 1-factor);
        }
      }
      lastTime = time;
      requestAnimationFrame( animate, renderer.domElement  );
      render();
    }

    function render() {
      renderer.render( scene, camera );
    }
  </script>
</body>
</html>